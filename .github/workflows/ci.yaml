name: Tp CICD

on:
  push:
    branches:
      - main
jobs:

  filter_path:
    uses: ./.github/workflows/filter_path.yaml

  scan_dependencies:
    if: needs.filter_path.outputs.backend == 'true' || needs.filter_path.outputs.frontend == 'true'
    needs:
      - filter_path
    uses: ./.github/workflows/scan_dependencies.yaml


  build_backend:
    if: needs.filter_path.outputs.backend == 'true'
    needs:
      - filter_path
      - scan_dependencies
    secrets: inherit
    uses: ./.github/workflows/build_backend.yaml

  build_frontend:
    if: needs.filter_path.outputs.frontend == 'true'
    needs:
      - filter_path
      - scan_dependencies
    secrets: inherit
    uses: ./.github/workflows/build_frontend.yaml
